<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RoboCup2D Tutorial: Configuring the trainer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RoboCup2D Tutorial
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_sections_configuring-the-trainer.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Configuring the trainer </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3>SampleTrainer</h3>
<p>Like the coach (sample_coach) and the player (sample_player) there is a sample_trainer class. Basically, this class loads the 11 players and the coach team. However, you may allow the players to do nothing or simply execute specific tasks which go in the actionImpl method.</p>
<p>The SampleTrainer class extends the TrainerAgent class and it is recommended that you go through the librcsc source code and look at trainer_agent.cpp and trainer_agent.h files. Methods are documented and they are easy to understand by only analysing their source code. Some interesting methods of this class are:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> doMoveBall( <span class="keyword">const</span> Vector2D &amp; pos, <span class="keyword">const</span> Vector2D &amp; vel )</div><div class="line"><span class="keywordtype">bool</span> doMovePlayer( <span class="keyword">const</span> std::string &amp; teamname, <span class="keyword">const</span> <span class="keywordtype">int</span> unum, <span class="keyword">const</span> Vector2D &amp; pos )</div><div class="line"><span class="keywordtype">bool</span> doRecover()</div><div class="line">bool doChangeMode( const PlayMode mode )</div><div class="line"><span class="keywordtype">bool</span> doChangePlayerType( const std::<span class="keywordtype">string</span> &amp; teamname, const <span class="keywordtype">int</span> unum, const <span class="keywordtype">int</span> type )</div></div><!-- fragment --><p>Open the file sample_trainer.cpp e find the actionImpl method. It is something like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span></div><div class="line">SampleTrainer::actionImpl()</div><div class="line">{</div><div class="line">    [...]</div><div class="line">    <span class="comment">// Add your code here.</span></div><div class="line"></div><div class="line">    <span class="comment">//sampleAction();</span></div><div class="line">    <span class="comment">//recoverForever();</span></div><div class="line">    <span class="comment">//doSubstitute();</span></div><div class="line">    <span class="comment">//doKeepaway();</span></div><div class="line">}</div></div><!-- fragment --><ul>
<li>sampleAction(): if a player is controlling the ball (if it is in the kickable area), then the trainer will put the ball in the field centre dropping it with a random speed.</li>
<li>recoverForever(): calls doRecover() every 50 cycles (recovers players' stamina).</li>
<li>doSubstitute(): changes players type. (To see players type, press Ctrl+H in the monitor during a match).</li>
</ul>
<p>If you wish to use these methods, just uncomment the lines. The first method is not useful if you wish to train your team in specific game situations. This method is suitable when a desired game state is executed and you want to execute it again. Even if you want to call sampleAction(), open its implementation and change the variable value s_state from 0 to 1 (if you do not do this then the trainer will not do anything except for starting a player which is in its kickable area). The method implementation consists of a finite-state machine which uses a switch and the variable s_state to store the currente state.</p>
<h3>Configuring the trainer</h3>
<p>Go to the team scr directory and open the file train.sh.</p>
<ul>
<li>Formation</li>
</ul>
<p>Locate this line: </p><div class="fragment"><div class="line">config_dir=&quot;${DIR}/formations-train&quot;</div></div><!-- fragment --><p>By doing this, you will be using your own formations. If you do not know how to create and edit formations, read the tutorial https://github.com/RoboCup2D/tutorial/blob/master/sections/formations-with-fedit.md "Creating formations with fedit". Obviously, you can use the formations in the folder formations-dt. However, as the goal here is to use your own strategy, it is recommend that you create your formations.</p>
<p>Locate this line: </p><div class="fragment"><div class="line">trainer=&quot;${DIR}/helios_trainer&quot;</div></div><!-- fragment --><p> Put the desired trainer executable name of your team.</p>
<ul>
<li>Players</li>
</ul>
<p>The following code loads the player and the trainer. The original code loads a single player: </p><div class="fragment"><div class="line">OPT=&quot;-h ${host} -t ${teamname}&quot;</div><div class="line">OPT=&quot;${OPT} --player-config ${config} --config_dir ${config_dir}&quot;</div><div class="line">OPT=&quot;${OPT} ${debugopt}&quot;</div><div class="line"></div><div class="line">#if [ $number -gt 0 ]; then</div><div class="line">#  $player ${OPT} -g &amp;</div><div class="line">#  $sleepprog $goaliesleep</div><div class="line">#fi</div><div class="line"></div><div class="line">#for (( i=2; i&lt;=${number}; i=$i+1 )) ; do</div><div class="line">  $player ${OPT} -n 11 &amp;</div><div class="line">  $sleepprog $sleeptime</div><div class="line">#done</div><div class="line"></div><div class="line">#if [ &quot;${usecoach}&quot; = &quot;true&quot; ]; then</div><div class="line">#  $coach -h $host -t $teamname &amp;</div><div class="line">#fi</div><div class="line"></div><div class="line">$trainer -h $host -t $teamname &amp;</div></div><!-- fragment --><p> Replace the lines above with the following lines:</p>
<p>```bash opt="--player-config ${config} --config_dir ${config_dir}" opt="${opt} -h ${host} -p ${port} -t ${teamname}" opt="${opt} ${fullstateopt}" opt="${opt} --debug_server_host ${debug_server_host}" opt="${opt} --debug_server_port ${debug_server_port}" opt="${opt} ${offline_logging}" opt="${opt} ${debugopt}"</p>
<p>ping -c 1 $host</p>
<h1>Loads the goalkeeper</h1>
<p>if [ $number -gt 0 ]; then offline_number="" if [ X"${offline_mode}" != X'' ]; then offline_number="--offline_client_number 1" if [ $unum -eq 0 ]; then $player ${opt} -g ${offline_number} &amp; $sleepprog $goaliesleep elif [ $unum -eq 1 ]; then $player ${opt} -g ${offline_number} &amp; $sleepprog $goaliesleep fi else $player ${opt} -g &amp; $sleepprog $goaliesleep fi fi</p>
<h1>Loads the number - 1 players</h1>
<p>i=2 while [ $i -le ${number} ] ; do offline_number="" if [ X"${offline_mode}" != X'' ]; then offline_number="--offline_client_number ${i}" if [ $unum -eq 0 ]; then $player ${opt} ${offline_number} &amp; $sleepprog $sleeptime elif [ $unum -eq $i ]; then $player ${opt} ${offline_number} &amp; $sleepprog $sleeptime fi else $player ${opt} &amp; $sleepprog $sleeptime fi</p>
<p>i=<code>expr $i + 1</code> done</p>
<h1>Loads the coach</h1>
<p>if [ "${usecoach}" = "true" ]; then coachopt="--coach-config ${coach_conf}" coachopt="${coachopt} -h ${host} -p ${coach_port} -t ${teamname}" coachopt="${coachopt} ${team_graphic}" coachopt="${coachopt} --debug_server_host ${debug_server_host}" coachopt="${coachopt} --debug_server_port ${debug_server_port}" coachopt="${coachopt} ${offline_logging}" coachopt="${coachopt} ${debugopt}"</p>
<p>if [ X"${offline_mode}" != X'' ]; then offline_mode="--offline_client_mode" if [ $unum -eq 0 ]; then $coach ${coachopt} ${offline_mode} &amp; elif [ $unum -eq 12 ]; then $coach ${coachopt} ${offline_mode} &amp; fi else $coach ${coachopt} &amp; fi fi</p>
<p>$trainer -h $host -t $teamname &amp; </p><div class="fragment"><div class="line">If you do not want to load the goalkeeper, comment the lines above related to it and change the variable i before the players loading for i=1.</div><div class="line">You can load many players as you want just changing the value of the variable number.</div><div class="line"></div><div class="line">### Executing the trainer</div><div class="line"></div><div class="line">Before executing the trainer, you must run the server in coach mode (you can also disable the offside rule):</div><div class="line"></div><div class="line">```bash</div><div class="line">$ rcssserver server::coach_w_referee=on server::use_offside=false</div></div><!-- fragment --><p>To know more about server options: </p><div class="fragment"><div class="line">$ rcssserver server::help</div></div><!-- fragment --><p>Run the monitor: </p><div class="fragment"><div class="line">$ rcssmonitor &amp;</div></div><!-- fragment --><p> or </p><div class="fragment"><div class="line">$ soccerwindow2 &amp; </div></div><!-- fragment --><p> Now, run the train.sh file that you had modified. </p><div class="fragment"><div class="line">$ ./train.sh</div></div><!-- fragment --><p> <b>You do not need to run the sample_trainer as this is already done in the script train.sh</b></p>
<p>You may also specify some custom options: </p><div class="fragment"><div class="line">$ ./train.sh --help</div><div class="line">Usage: ./train.sh [options]</div><div class="line">  -h, --host HOST           specifies server host</div><div class="line">  -t, --teamname TEAMNAME   specifies team name</div></div><!-- fragment --><p> The default host is localhost and the team name is HELIOS_base. It is possible to change this by using: </p><div class="fragment"><div class="line">$ ./train.sh -t Barcelona</div></div><!-- fragment --><p> To add anoher team on the field, run the script start.sh in the opponent team scr directory. </p><div class="fragment"><div class="line">$ ./start.sh -t opponent_team_name</div></div><!-- fragment --><p>Now you can train in your team against another team to test specific situations! </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
